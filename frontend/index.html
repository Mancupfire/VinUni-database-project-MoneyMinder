<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MoneyMinder - Personal Finance Management</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
  <!-- Login Page -->
  <div id="loginPage" class="auth-container">
    <div class="auth-card">
      <div class="text-center mb-4">
        <i class="bi bi-piggy-bank-fill" style="font-size: 3rem; color: var(--primary-green);"></i>
        <h2 class="mt-2">MoneyMinder</h2>
        <p class="text-muted">Personal Finance Management</p>
      </div>

      <form id="loginForm">
        <div class="mb-3">
          <label for="loginEmail" class="form-label">Email</label>
          <input type="email" class="form-control" id="loginEmail" required>
        </div>
        <div class="mb-3">
          <label for="loginPassword" class="form-label">Password</label>
          <input type="password" class="form-control" id="loginPassword" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Login</button>
      </form>

      <div class="text-center mt-3">
        <p>Don't have an account? <a href="#" id="showRegister">Register</a></p>
      </div>

      <div class="mt-4 p-3 bg-light rounded">
        <p class="mb-1 small"><strong>Demo Accounts:</strong></p>
        <p class="mb-0 small">Email: <code>john.doe@example.com</code></p>
        <p class="mb-0 small">Password: <code>Demo@2024</code></p>
      </div>
    </div>
  </div>

  <!-- Register Page -->
  <div id="registerPage" class="auth-container" style="display: none;">
    <div class="auth-card">
      <div class="text-center mb-4">
        <i class="bi bi-piggy-bank-fill" style="font-size: 3rem; color: var(--primary-green);"></i>
        <h2 class="mt-2">Create Account</h2>
      </div>

      <form id="registerForm">
        <div class="mb-3">
          <label for="regUsername" class="form-label">Username</label>
          <input type="text" class="form-control" id="regUsername" required>
        </div>
        <div class="mb-3">
          <label for="regEmail" class="form-label">Email</label>
          <input type="email" class="form-control" id="regEmail" required>
        </div>
        <div class="mb-3">
          <label for="regPassword" class="form-label">Password</label>
          <input type="password" class="form-control" id="regPassword" required>
        </div>
        <div class="mb-3">
          <label for="regCurrency" class="form-label">Base Currency</label>
          <select class="form-select" id="regCurrency">
            <option value="VND" selected>VND - Vietnamese Dong</option>
            <option value="USD">USD - US Dollar</option>
            <option value="EUR">EUR - Euro</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary w-100">Register</button>
      </form>

      <div class="text-center mt-3">
        <p>Already have an account? <a href="#" id="showLogin">Login</a></p>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div id="mainApp" style="display: none;">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <button class="sidebar-toggle" id="sidebarToggle">
          <i class="bi bi-list"></i>
        </button>
      </div>

      <nav class="sidebar-nav">
        <a href="#" class="nav-link active" data-page="dashboard">
          <i class="bi bi-speedometer2"></i>
          <span class="sidebar-text">Dashboard</span>
        </a>
        <a href="#" class="nav-link" data-page="transactions">
          <i class="bi bi-receipt"></i>
          <span class="sidebar-text">Transactions</span>
        </a>
        <a href="#" class="nav-link" data-page="accounts">
          <i class="bi bi-wallet2"></i>
          <span class="sidebar-text">Accounts</span>
        </a>
        <a href="#" class="nav-link" data-page="budgets">
          <i class="bi bi-pie-chart"></i>
          <span class="sidebar-text">Budgets</span>
        </a>
        <a href="#" class="nav-link" data-page="groups">
          <i class="bi bi-people"></i>
          <span class="sidebar-text">Groups</span>
        </a>
        <a href="#" class="nav-link" data-page="recurring">
          <i class="bi bi-arrow-repeat"></i>
          <span class="sidebar-text">Recurring</span>
        </a>
        <a href="#" class="nav-link" data-page="analytics">
          <i class="bi bi-graph-up"></i>
          <span class="sidebar-text">Analytics</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="user-avatar">
          <i class="bi bi-person-circle"></i>
        </div>
        <div class="sidebar-text">
          <div class="user-name" id="userDisplay"></div>
          <button class="btn btn-sm btn-outline-light mt-2" id="logoutBtn">
            <i class="bi bi-box-arrow-right"></i> Logout
          </button>
        </div>
      </div>
    </div>

    <!-- Top Header -->
    <header class="top-header">
      <div class="header-logo">
        <i class="bi bi-piggy-bank-fill"></i>
        <span>MoneyMinder</span>
      </div>
      <div class="header-actions">
        <!-- Notifications Bell -->
        <div class="notification-wrapper">
          <button class="btn btn-link notification-btn" id="notificationBtn">
            <i class="bi bi-bell"></i>
            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
          </button>
          <div class="notification-dropdown" id="notificationDropdown" style="display: none;">
            <div class="notification-header">
              <h6>Notifications</h6>
              <button class="btn btn-sm btn-link" id="markAllReadBtn">Mark all read</button>
            </div>
            <div class="notification-list" id="notificationList">
              <div class="text-center py-3 text-muted">
                <i class="bi bi-bell-slash"></i>
                <p class="mb-0 mt-2 small">No notifications</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
      <div class="container-fluid py-4">
        <!-- Dashboard Page -->
        <div id="dashboardPage" class="content-page">
          <div class="page-header">
            <h1 class="page-title">Dashboard</h1>
          </div>

          <!-- Summary Cards -->
          <div class="row g-4 mb-4">
            <div class="col-md-3">
              <div class="stat-card">
                <div class="stat-icon primary">
                  <i class="bi bi-wallet2"></i>
                </div>
                <div class="stat-label">Total Balance</div>
                <div class="stat-value" id="totalBalance">₫0</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card">
                <div class="stat-icon success">
                  <i class="bi bi-arrow-down-circle"></i>
                </div>
                <div class="stat-label">Income (This Month)</div>
                <div class="stat-value" id="monthIncome">₫0</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card">
                <div class="stat-icon danger">
                  <i class="bi bi-arrow-up-circle"></i>
                </div>
                <div class="stat-label">Expense (This Month)</div>
                <div class="stat-value" id="monthExpense">₫0</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card">
                <div class="stat-icon warning">
                  <i class="bi bi-graph-up"></i>
                </div>
                <div class="stat-label">Net Balance</div>
                <div class="stat-value" id="netBalance">₫0</div>
              </div>
            </div>
          </div>

          <!-- Trend Charts -->
          <div class="row g-4 mb-4">
            <div class="col-lg-6">
              <div class="card">
                <div class="card-header">
                  <h5 class="mb-0">6-Month Trend</h5>
                </div>
                <div class="card-body">
                  <canvas id="monthlyTrendChart"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                  <h5 class="mb-0">Yearly Summary</h5>
                  <select class="form-select form-select-sm" id="yearSelector" style="width: auto;">
                    <!-- Will be populated dynamically -->
                  </select>
                </div>
                <div class="card-body">
                  <canvas id="yearlySummaryChart"></canvas>
                </div>
              </div>
            </div>
          </div>

          <!-- Recent Transactions -->
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Transactions</h5>
              <button class="btn btn-primary btn-sm" data-page="transactions">View All</button>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover" id="recentTransactionsTable">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Description</th>
                      <th>Category</th>
                      <th>Account</th>
                      <th>Amount</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Transactions Page -->
        <div id="transactionsPage" class="content-page" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Transactions</h2>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addTransactionModal">
              <i class="bi bi-plus-circle"></i> Add Transaction
            </button>
          </div>

          <!-- Filters -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-3">
                  <label class="form-label">Start Date</label>
                  <input type="date" class="form-control" id="filterStartDate">
                </div>
                <div class="col-md-3">
                  <label class="form-label">End Date</label>
                  <input type="date" class="form-control" id="filterEndDate">
                </div>
                <div class="col-md-3">
                  <label class="form-label">Account</label>
                  <select class="form-select" id="filterAccount">
                    <option value="">All Accounts</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label class="form-label">&nbsp;</label>
                  <button class="btn btn-primary w-100" id="applyFilters">Apply Filters</button>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover" id="transactionsTable">
                  <thead>
                    <tr>
                      <th data-sort="date" onclick="sortTransactions('date')" style="cursor: pointer;" class="sort-desc">
                        Date <i class="bi bi-arrow-down-up"></i>
                      </th>
                      <th>Description</th>
                      <th>Category</th>
                      <th>Account</th>
                      <th data-sort="amount" onclick="sortTransactions('amount')" style="cursor: pointer;">
                        Amount <i class="bi bi-arrow-down-up"></i>
                      </th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Accounts Page -->
        <div id="accountsPage" class="content-page" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Accounts</h2>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAccountModal">
              <i class="bi bi-plus-circle"></i> Add Account
            </button>
          </div>

          <div class="row" id="accountsContainer"></div>
        </div>

        <!-- Analytics Page -->
        <div id="analyticsPage" class="content-page" style="display: none;">
          <h2 class="mb-4">Analytics & Reports</h2>

          <!-- Budget Status -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">Budget Status</h5>
            </div>
            <div class="card-body" id="budgetStatus">
              <p class="text-muted">Loading budget data...</p>
            </div>
          </div>

          <!-- Spending by Category -->
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">Spending by Category</h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table" id="categorySpendingTable">
                  <thead>
                    <tr>
                      <th>Category</th>
                      <th>Type</th>
                      <th>Transactions</th>
                      <th>Total Amount</th>
                      <th>Average</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Budgets Page -->
        <div id="budgetsPage" class="content-page" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Budget Management</h2>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBudgetModal">
              <i class="bi bi-plus-circle"></i> Create Budget
            </button>
          </div>

          <!-- Filters and Sort -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label">Filter by Status</label>
                  <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-outline-primary budget-filter-btn active" data-filter="all" onclick="filterBudgets('all')">
                      All
                    </button>
                    <button type="button" class="btn btn-outline-danger budget-filter-btn" data-filter="exceeded" onclick="filterBudgets('exceeded')">
                      Exceeded
                    </button>
                    <button type="button" class="btn btn-outline-warning budget-filter-btn" data-filter="warning" onclick="filterBudgets('warning')">
                      Warning
                    </button>
                    <button type="button" class="btn btn-outline-info budget-filter-btn" data-filter="normal" onclick="filterBudgets('normal')">
                      Normal
                    </button>
                    <button type="button" class="btn btn-outline-success budget-filter-btn" data-filter="safe" onclick="filterBudgets('safe')">
                      Safe
                    </button>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label">Sort by</label>
                  <div class="btn-group w-100" role="group">
                    <button type="button" class="btn btn-outline-secondary budget-sort-btn active" data-sort="status" onclick="sortBudgets('status')">
                      Status <i class="bi bi-arrow-down"></i>
                    </button>
                    <button type="button" class="btn btn-outline-secondary budget-sort-btn" data-sort="amount" onclick="sortBudgets('amount')">
                      Limit <i class="bi bi-arrow-down-up"></i>
                    </button>
                    <button type="button" class="btn btn-outline-secondary budget-sort-btn" data-sort="spent" onclick="sortBudgets('spent')">
                      Spent <i class="bi bi-arrow-down-up"></i>
                    </button>
                    <button type="button" class="btn btn-outline-secondary budget-sort-btn" data-sort="category" onclick="sortBudgets('category')">
                      Category <i class="bi bi-arrow-down-up"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row" id="budgetsContainer">
            <div class="col-12 text-center text-muted py-5">
              <i class="bi bi-wallet2" style="font-size: 3rem;"></i>
              <p>No budgets found. Create one to start tracking your spending limits!</p>
            </div>
          </div>
        </div>

        <!-- Groups Page -->
        <div id="groupsPage" class="content-page" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Shared Expense Groups</h2>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGroupModal">
              <i class="bi bi-plus-circle"></i> Create Group
            </button>
          </div>

          <div class="row" id="groupsContainer">
            <div class="col-12 text-center text-muted py-5">
              <i class="bi bi-people" style="font-size: 3rem;"></i>
              <p>No groups yet. Create a group to track shared expenses with family or roommates!</p>
            </div>
          </div>
        </div>

        <!-- Recurring Payments Page -->
        <div id="recurringPage" class="content-page" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Recurring Payments</h2>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addRecurringModal">
              <i class="bi bi-plus-circle"></i> Add Recurring Payment
            </button>
          </div>

          <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> Manage your subscriptions and recurring bills here. Execute them manually
            or
            set up automatic payments.
          </div>

          <div class="mb-3 d-flex gap-2">
            <select class="form-select w-auto" id="recurringSortBy">
              <option value="next_due_date">Sort by Date</option>
              <option value="amount">Sort by Amount</option>
            </select>
            <select class="form-select w-auto" id="recurringSortOrder">
              <option value="asc">Ascending</option>
              <option value="desc">Descending</option>
            </select>
            <button class="btn btn-secondary" id="applyRecurringSort">
              <i class="bi bi-sort-down"></i> Apply Sort
            </button>
          </div>

          <div class="row" id="recurringContainer">
            <div class="col-12 text-center text-muted py-5">
              <i class="bi bi-arrow-repeat" style="font-size: 3rem;"></i>
              <p>No recurring payments configured. Add one to automate your regular expenses!</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Transaction Modal -->
    <div class="modal fade" id="addTransactionModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Transaction</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addTransactionForm">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">Account</label>
                <select class="form-select" id="txnAccount" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Type</label>
                <select class="form-select" id="txnType" required>
                  <option value="Expense">Expense</option>
                  <option value="Income">Income</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="txnCategory" required>
                  <option value="other">Other (Custom)</option>
                </select>
              </div>
              <div class="mb-3" id="customCategoryField" style="display: none;">
                <label class="form-label">Custom Category Name</label>
                <input type="text" class="form-control" id="txnCustomCategory" placeholder="Enter category name">
                <small class="text-muted">Specify your own category</small>
              </div>
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="txnForeignCurrency">
                  <label class="form-check-label" for="txnForeignCurrency">
                    Foreign Currency Transaction
                  </label>
                </div>
              </div>
              <div id="currencyFields" style="display: none;">
                <div class="mb-3">
                  <label class="form-label">Foreign Amount</label>
                  <input type="number" class="form-control" id="txnOriginalAmount" step="0.01">
                  <small class="text-muted">Use negative value for expenses</small>
                </div>
                <div class="mb-3">
                  <label class="form-label">Currency Code</label>
                  <select class="form-select" id="txnCurrencyCode">
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - British Pound</option>
                    <option value="JPY">JPY - Japanese Yen</option>
                    <option value="CNY">CNY - Chinese Yuan</option>
                    <option value="KRW">KRW - South Korean Won</option>
                    <option value="THB">THB - Thai Baht</option>
                    <option value="SGD">SGD - Singapore Dollar</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Exchange Rate</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="txnExchangeRate" step="0.0001" placeholder="e.g., 23500 (VND per USD)">
                    <button class="btn btn-outline-secondary" type="button" id="fetchExchangeRate">
                      <i class="bi bi-arrow-repeat"></i> Get Rate
                    </button>
                  </div>
                  <small class="text-muted">Base Amount = Foreign Amount × Exchange Rate</small>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Amount (in VND)</label>
                <input type="number" class="form-control" id="txnAmount" step="0.01" required>
                <small class="text-muted">Use negative value for expenses. Auto-calculated if using foreign currency.</small>
              </div>
              <div class="mb-3">
                <label class="form-label">Group (Optional)</label>
                <select class="form-select" id="txnGroup">
                  <option value="">None (Personal)</option>
                </select>
                <small class="text-muted">Select a group to track shared expenses</small>
              </div>
              <div class="mb-3">
                <label class="form-label">Date</label>
                <input type="datetime-local" class="form-control" id="txnDate" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="txnDescription" rows="2"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Add Transaction</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit Transaction Modal -->
    <div class="modal fade" id="editTransactionModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Transaction</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="editTransactionForm">
            <div class="modal-body">
              <input type="hidden" id="editTxnId">
              <div class="mb-3">
                <label class="form-label">Account</label>
                <select class="form-select" id="editTxnAccount" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Type</label>
                <select class="form-select" id="editTxnType" required>
                  <option value="Expense">Expense</option>
                  <option value="Income">Income</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="editTxnCategory" required>
                  <option value="other">Other (Custom)</option>
                </select>
              </div>
              <div class="mb-3" id="editCustomCategoryField" style="display: none;">
                <label class="form-label">Custom Category Name</label>
                <input type="text" class="form-control" id="editTxnCustomCategory" placeholder="Enter category name">
                <small class="text-muted">Specify your own category</small>
              </div>
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="editTxnForeignCurrency">
                  <label class="form-check-label" for="editTxnForeignCurrency">
                    Foreign Currency Transaction
                  </label>
                </div>
              </div>
              <div id="editCurrencyFields" style="display: none;">
                <div class="mb-3">
                  <label class="form-label">Foreign Amount</label>
                  <input type="number" class="form-control" id="editTxnOriginalAmount" step="0.01">
                  <small class="text-muted">Use negative value for expenses</small>
                </div>
                <div class="mb-3">
                  <label class="form-label">Currency Code</label>
                  <select class="form-select" id="editTxnCurrencyCode">
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - British Pound</option>
                    <option value="JPY">JPY - Japanese Yen</option>
                    <option value="CNY">CNY - Chinese Yuan</option>
                    <option value="KRW">KRW - South Korean Won</option>
                    <option value="THB">THB - Thai Baht</option>
                    <option value="SGD">SGD - Singapore Dollar</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Exchange Rate</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="editTxnExchangeRate" step="0.0001" placeholder="e.g., 23500 (VND per USD)">
                    <button class="btn btn-outline-secondary" type="button" id="editFetchExchangeRate">
                      <i class="bi bi-arrow-repeat"></i> Get Rate
                    </button>
                  </div>
                  <small class="text-muted">Base Amount = Foreign Amount × Exchange Rate</small>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Amount (in VND)</label>
                <input type="number" class="form-control" id="editTxnAmount" step="0.01" required>
                <small class="text-muted">Use negative value for expenses. Auto-calculated if using foreign currency.</small>
              </div>
              <div class="mb-3">
                <label class="form-label">Group (Optional)</label>
                <select class="form-select" id="editTxnGroup">
                  <option value="">None (Personal)</option>
                </select>
                <small class="text-muted">Select a group to track shared expenses</small>
              </div>
              <div class="mb-3">
                <label class="form-label">Date</label>
                <input type="datetime-local" class="form-control" id="editTxnDate" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="editTxnDescription" rows="2"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Add Account Modal -->
    <div class="modal fade" id="addAccountModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Account</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addAccountForm">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">Account Name</label>
                <input type="text" class="form-control" id="accName" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Account Type</label>
                <select class="form-select" id="accType" required>
                  <option value="Cash">Cash</option>
                  <option value="Bank Account">Bank Account</option>
                  <option value="Credit Card">Credit Card</option>
                  <option value="E-Wallet">E-Wallet</option>
                  <option value="Investment">Investment</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Initial Balance</label>
                <input type="number" class="form-control" id="accBalance" step="0.01" value="0">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Add Account</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Add Budget Modal -->
    <div class="modal fade" id="addBudgetModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create Budget</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addBudgetForm">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="budgetCategory" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Budget Limit</label>
                <input type="number" class="form-control" id="budgetLimit" step="0.01" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Start Date</label>
                <input type="date" class="form-control" id="budgetStartDate" required>
              </div>
              <div class="mb-3">
                <label class="form-label">End Date</label>
                <input type="date" class="form-control" id="budgetEndDate" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Create Budget</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit Budget Modal -->
    <div class="modal fade" id="editBudgetModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Budget</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="editBudgetForm">
            <div class="modal-body">
              <input type="hidden" id="editBudgetId">
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="editBudgetCategory" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Budget Limit</label>
                <input type="number" class="form-control" id="editBudgetLimit" step="0.01" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Start Date</label>
                <input type="date" class="form-control" id="editBudgetStartDate" required>
              </div>
              <div class="mb-3">
                <label class="form-label">End Date</label>
                <input type="date" class="form-control" id="editBudgetEndDate" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Add Group Modal -->
    <div class="modal fade" id="addGroupModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create Group</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addGroupForm">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">Group Name</label>
                <input type="text" class="form-control" id="groupName"
                  placeholder="e.g., Family Budget, Trip to Vietnam" required>
              </div>
              <div class="alert alert-info mb-0">
                <small><i class="bi bi-info-circle"></i> After creating, you can add members by their email
                  addresses.</small>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Create Group</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Add Member to Group Modal -->
    <div class="modal fade" id="addMemberModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Member</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addMemberForm">
            <div class="modal-body">
              <input type="hidden" id="memberGroupId">
              <div class="mb-3">
                <label class="form-label">Member Email</label>
                <input type="email" class="form-control" id="memberEmail" placeholder="user@example.com" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Add Member</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Group Details Modal -->
    <div class="modal fade" id="groupDetailsModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="groupDetailsName">Group Details</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-6">
                <h6 class="mb-3">Members</h6>
                <div id="groupMembersList" class="mb-3">
                  <!-- Members will be loaded here -->
                </div>
              </div>
              <div class="col-md-6">
                <h6 class="mb-3">Recent Transactions</h6>
                <div id="groupTransactionsList" style="max-height: 400px; overflow-y: auto;">
                  <!-- Transactions will be loaded here -->
                </div>
              </div>
            </div>
            <div class="alert alert-info mt-3 mb-2">
              <strong>Total Group Spending:</strong> <span id="groupTotalSpent">₫0</span>
            </div>
            <div class="alert alert-success mt-2">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <strong>Split per person (<span id="groupMemberCount">0</span> members):</strong>
                </div>
                <div class="fs-5 fw-bold">
                  <span id="groupSplitAmount">₫0</span>
                </div>
              </div>
              <small class="text-muted">Each member should pay this amount</small>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Recurring Payment Modal -->
    <div class="modal fade" id="addRecurringModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Recurring Payment</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="addRecurringForm">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">Description</label>
                <input type="text" class="form-control" id="recurringDesc" placeholder="e.g., Netflix Subscription"
                  required>
              </div>
              <div class="mb-3">
                <label class="form-label">Account</label>
                <select class="form-select" id="recurringAccount" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="recurringCategory" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Amount</label>
                <input type="number" class="form-control" id="recurringAmount" step="0.01" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Frequency</label>
                <select class="form-select" id="recurringFrequency" required>
                  <option value="Daily">Daily</option>
                  <option value="Weekly">Weekly</option>
                  <option value="Monthly" selected>Monthly</option>
                  <option value="Yearly">Yearly</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Start Date</label>
                <input type="date" class="form-control" id="recurringStartDate" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Add Recurring Payment</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit Recurring Payment Modal -->
    <div class="modal fade" id="editRecurringModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Recurring Payment</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form id="editRecurringForm">
            <div class="modal-body">
              <input type="hidden" id="editRecurringId">
              <div class="mb-3">
                <label class="form-label">Account</label>
                <select class="form-select" id="editRecurringAccount" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-select" id="editRecurringCategory" required></select>
              </div>
              <div class="mb-3">
                <label class="form-label">Amount</label>
                <input type="number" class="form-control" id="editRecurringAmount" step="0.01" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Frequency</label>
                <select class="form-select" id="editRecurringFrequency" required>
                  <option value="Daily">Daily</option>
                  <option value="Weekly">Weekly</option>
                  <option value="Monthly">Monthly</option>
                  <option value="Yearly">Yearly</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Start Date</label>
                <input type="date" class="form-control" id="editRecurringStartDate" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div> <!-- Close main-content -->

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/app.js"></script>
</body>

</html>